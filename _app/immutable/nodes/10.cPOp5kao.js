import"../chunks/DsnmJJEf.js";import{i as v0}from"../chunks/BVbvjRkN.js";import{p as n0,f as v,t as C,d as m,e as c0,r as h,l as Q,k as K,g as c,c as u,b as d,s as F,h as w,a as W,j,ai as g0,n as Z}from"../chunks/4GbpYj1Z.js";import{d as p0,s as U}from"../chunks/BtTk71Kd.js";import{a as k,r as t0}from"../chunks/CK5eLMkr.js";import{i as N}from"../chunks/C-F78KSZ.js";import{e as e0,i as s0}from"../chunks/C_cjGUXz.js";import{s as T}from"../chunks/CG_wtlq_.js";import{s as r0}from"../chunks/B00MqyoI.js";import{g as b0,h as w0}from"../chunks/D5MljCm_.js";const x0=""+new URL("../assets/monster.Csm6RS2X.svg",import.meta.url).href,y0="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23000000'%20width='800px'%20height='800px'%20viewBox='0%200%201920%201920'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M960%200C430.645%200%200%20430.645%200%20960s430.645%20960%20960%20960%20960-430.645%20960-960S1489.355%200%20960%200'%20fill-rule='evenodd'/%3e%3c/svg%3e",k0="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='iso-8859-1'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20height='800px'%20width='800px'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='0%200%20511.882%20511.882'%20xml:space='preserve'%3e%3cpolygon%20style='fill:%23F6BB42;'%20points='350.216,176.572%20278.374,158.615%2037.038,264.123%200,338.207%20125.753,374.324%20386.13,258.531%20'/%3e%3cpolygon%20style='fill:%23FFCE54;'%20points='350.216,176.572%20107.756,284.345%20125.753,374.324%20386.13,258.531%20'/%3e%3cpolygon%20style='fill:%23E8AA3D;'%20points='107.756,284.345%2037.038,264.123%200.015,338.207%20125.753,374.324%20'/%3e%3cpolygon%20style='fill:%23F6BB42;'%20points='475.969,212.682%20404.127,194.717%20162.791,300.232%20125.753,374.324%20251.504,410.41%20511.882,294.625%20'/%3e%3cpolygon%20style='fill:%23FFCE54;'%20points='475.969,212.682%20233.508,320.431%20251.504,410.41%20511.882,294.625%20'/%3e%3cpolygon%20style='fill:%23E8AA3D;'%20points='233.508,320.431%20162.791,300.232%20125.753,374.324%20251.504,410.41%20'/%3e%3cpolygon%20style='fill:%23F6BB42;'%20points='396.316,119.429%20324.488,101.473%20103.867,198.435%2066.843,272.519%20192.596,308.621%20432.245,201.379%20'/%3e%3cpolygon%20style='fill:%23FFCE54;'%20points='396.316,119.429%20174.6,218.641%20192.596,308.621%20432.245,201.379%20'/%3e%3cpolygon%20style='fill:%23E8AA3D;'%20points='174.6,218.641%20103.867,198.435%2066.843,272.519%20192.596,308.621%20'/%3e%3c/svg%3e",L0="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23AFE1AF'%20width='800px'%20height='800px'%20viewBox='0%200%2032%2032'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%3e%3ctitle%3eheat%3c/title%3e%3cpath%20d='M7.442%2015.050c-0.726-0.745-1.38-1.566-1.948-2.448l-0.037-0.062c-0.805-1.614-1.276-3.516-1.276-5.528%200-0.901%200.095-1.78%200.274-2.628l-0.015%200.082c0.008-0.052%200.012-0.111%200.012-0.172%200-0.69-0.56-1.25-1.25-1.25-0.641%200-1.17%200.483-1.242%201.105l-0.001%200.006c-0.179%200.868-0.282%201.865-0.282%202.886%200%202.465%200.599%204.79%201.658%206.838l-0.039-0.083c0.695%201.103%201.451%202.062%202.296%202.934l-0.005-0.005c0.597%200.626%201.157%201.301%201.67%202.013l0.039%200.056c0.993%201.53%201.584%203.402%201.584%205.411%200%201.078-0.17%202.116-0.485%203.090l0.020-0.071c-0.036%200.111-0.056%200.238-0.056%200.371%200%200.558%200.365%201.030%200.87%201.191l0.009%200.002c0.11%200.036%200.237%200.057%200.369%200.057%200.001%200%200.002%200%200.003%200h-0c0.558-0%201.030-0.366%201.191-0.87l0.002-0.009c0.374-1.129%200.589-2.429%200.589-3.779%200-2.528-0.756-4.88-2.053-6.841l0.029%200.046c-0.622-0.871-1.253-1.636-1.934-2.354l0.009%200.010zM16.897%2015.11c-0.884-0.907-1.68-1.907-2.371-2.982l-0.045-0.075c-0.988-1.972-1.566-4.298-1.566-6.758%200-1.093%200.114-2.159%200.331-3.187l-0.018%200.1c0.005-0.043%200.008-0.093%200.008-0.144%200-0.69-0.56-1.25-1.25-1.25-0.632%200-1.154%200.469-1.238%201.077l-0.001%200.007c-0.214%201.031-0.336%202.215-0.336%203.428%200%202.914%200.706%205.662%201.956%208.085l-0.046-0.099c0.827%201.309%201.725%202.446%202.727%203.481l-0.005-0.006c0.722%200.758%201.401%201.576%202.023%202.438l0.047%200.069c1.217%201.877%201.941%204.171%201.941%206.635%200%201.32-0.208%202.592-0.593%203.784l0.024-0.087c-0.036%200.111-0.056%200.238-0.056%200.371%200%200.558%200.365%201.030%200.87%201.191l0.009%200.002c0.11%200.036%200.237%200.057%200.368%200.057%200.001%200%200.002%200%200.003%200h-0c0.558-0%201.030-0.366%201.191-0.87l0.002-0.009c0.441-1.333%200.695-2.867%200.695-4.461%200-2.982-0.89-5.755-2.418-8.070l0.034%200.055c-0.739-1.034-1.489-1.941-2.297-2.794l0.011%200.012zM28.24%2017.594c-0.621-0.87-1.253-1.634-1.933-2.351l0.009%200.009c-0.726-0.746-1.381-1.568-1.949-2.451l-0.037-0.062c-0.801-1.622-1.269-3.532-1.269-5.55%200-0.893%200.092-1.764%200.266-2.606l-0.014%200.083c0.006-0.047%200.010-0.1%200.010-0.155%200-0.635-0.474-1.16-1.087-1.24l-0.006-0.001c-0.043-0.005-0.093-0.008-0.144-0.008-0.638%200-1.165%200.472-1.252%201.087l-0.001%200.007c-0.174%200.859-0.273%201.847-0.273%202.858%200%202.474%200.595%204.808%201.651%206.868l-0.040-0.085c0.696%201.104%201.452%202.064%202.297%202.936l-0.005-0.005c0.595%200.625%201.155%201.3%201.668%202.010l0.039%200.057c0.993%201.53%201.584%203.402%201.584%205.411%200%201.078-0.17%202.116-0.484%203.089l0.020-0.071c-0.036%200.111-0.056%200.238-0.056%200.371%200%200.558%200.365%201.030%200.87%201.191l0.009%200.002c0.11%200.036%200.237%200.057%200.368%200.057%200.001%200%200.002%200%200.003%200h-0c0.558-0%201.030-0.366%201.191-0.87l0.002-0.009c0.373-1.129%200.589-2.428%200.589-3.778%200-2.528-0.755-4.88-2.053-6.842l0.029%200.046z'%3e%3c/path%3e%3c/svg%3e",C0="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.5%205.5L3.11612%206.11612C3.68206%206.68206%204.44964%207%205.25%207C6.05036%207%206.81794%206.68206%207.38388%206.11612L7.61612%205.88388C8.18206%205.31794%208.94964%205%209.75%205C10.5504%205%2011.3179%205.31794%2011.8839%205.88388L12.1161%206.11612C12.6821%206.68206%2013.4496%207%2014.25%207C15.0504%207%2015.8179%206.68206%2016.3839%206.11612L16.6161%205.88388C17.1821%205.31794%2017.9496%205%2018.75%205C19.5504%205%2020.3179%205.31794%2020.8839%205.88388L21.5%206.5M2.5%2011.5L3.11612%2012.1161C3.68206%2012.6821%204.44964%2013%205.25%2013C6.05036%2013%206.81794%2012.6821%207.38388%2012.1161L7.61612%2011.8839C8.18206%2011.3179%208.94964%2011%209.75%2011C10.5504%2011%2011.3179%2011.3179%2011.8839%2011.8839L12.1161%2012.1161C12.6821%2012.6821%2013.4496%2013%2014.25%2013C15.0504%2013%2015.8179%2012.6821%2016.3839%2012.1161L16.6161%2011.8839C17.1821%2011.3179%2017.9496%2011%2018.75%2011C19.5504%2011%2020.3179%2011.3179%2020.8839%2011.8839L21.5%2012.5M2.5%2017.5L3.11612%2018.1161C3.68206%2018.6821%204.44964%2019%205.25%2019C6.05036%2019%206.81794%2018.6821%207.38388%2018.1161L7.61612%2017.8839C8.18206%2017.3179%208.94964%2017%209.75%2017C10.5504%2017%2011.3179%2017.3179%2011.8839%2017.8839L12.1161%2018.1161C12.6821%2018.6821%2013.4496%2019%2014.25%2019C15.0504%2019%2015.8179%2018.6821%2016.3839%2018.1161L16.6161%2017.8839C17.1821%2017.3179%2017.9496%2017%2018.75%2017C19.5504%2017%2020.3179%2017.3179%2020.8839%2017.8839L21.5%2018.5'%20stroke='lightblue'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",N0="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20128%20128'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20aria-hidden='true'%20role='img'%20class='iconify%20iconify--noto'%20preserveAspectRatio='xMidYMid%20meet'%3e%3cpath%20d='M121.59%2060.83l-13.93-4.49c-8.91-2.94-14.13-10.15-16.58-19.21L84.95%207.27c-.16-.59-.55-1.38-1.75-1.38c-1.01%200-1.59.79-1.75%201.38l-6.13%2029.87c-2.46%209.06-7.67%2016.27-16.58%2019.21l-13.93%204.49c-1.97.64-2%203.42-.04%204.09l14.03%204.83c8.88%202.95%2014.06%2010.15%2016.52%2019.17l6.14%2029.53c.16.59.49%201.65%201.75%201.65c1.33%200%201.59-1.06%201.75-1.65l6.14-29.53c2.46-9.03%207.64-16.23%2016.52-19.17l14.03-4.83c1.94-.68%201.91-3.46-.06-4.1z'%20fill='%23fdd835'%3e%3c/path%3e%3cpath%20d='M122.91%2062.08c-.22-.55-.65-1.03-1.32-1.25l-13.93-4.49c-8.91-2.94-14.13-10.15-16.58-19.21L84.95%207.27c-.09-.34-.41-.96-.78-1.14l1.98%2029.97c1.47%2013.68%202.73%2020.12%2013.65%2022c9.38%201.62%2020.23%203.48%2023.11%203.98z'%20fill='%23ffee58'%3e%3c/path%3e%3cpath%20d='M122.94%2063.64l-24.16%205.54c-8.51%202.16-13.2%207.09-13.2%2019.99l-2.37%2030.94c.81-.08%201.47-.52%201.75-1.65l6.14-29.53c2.46-9.03%207.64-16.23%2016.52-19.17l14.03-4.83c.66-.24%201.08-.73%201.29-1.29z'%20fill='%23f4b400'%3e%3c/path%3e%3cg%3e%3cpath%20d='M41.81%2086.81c-8.33-2.75-9.09-5.85-10.49-11.08l-3.49-12.24c-.21-.79-2.27-.79-2.49%200L22.97%2074.8c-1.41%205.21-4.41%209.35-9.53%2011.04l-8.16%203.54c-1.13.37-1.15%201.97-.02%202.35l8.22%202.91c5.1%201.69%208.08%205.83%209.5%2011.02l2.37%2010.82c.22.79%202.27.79%202.48%200l2.78-10.77c1.41-5.22%203.57-9.37%2010.5-11.07l7.72-2.91c1.13-.39%201.12-1.99-.02-2.36l-7-2.56z'%20fill='%23fdd835'%3e%3c/path%3e%3cpath%20d='M28.49%2075.55c.85%207.86%201.28%2010.04%207.65%2011.67l13.27%202.59c-.14-.19-.34-.35-.61-.43l-7-2.57c-7.31-2.5-9.33-5.68-10.7-12.04c-1.37-6.36-2.83-10.51-2.83-10.51c-.51-1.37-1.24-1.3-1.24-1.3l1.46%2012.59z'%20fill='%23ffee58'%3e%3c/path%3e%3cpath%20d='M28.73%20102.99c0-7.41%204.05-11.08%2010.49-11.08l10.02-.41s-.58.77-1.59%201.01l-6.54%202.13c-5.55%202.23-8.08%203.35-9.8%2010.94c0%200-2.22%208.83-2.64%209.76c-.58%201.3-1.27%201.57-1.27%201.57l1.33-13.92z'%20fill='%23f4b400'%3e%3c/path%3e%3c/g%3e%3cpath%20d='M59.74%2028.14c.56-.19.54-.99-.03-1.15l-7.72-2.08a4.77%204.77%200%200%201-3.34-3.3L45.61%209.06c-.15-.61-1.02-.61-1.17.01l-2.86%2012.5a4.734%204.734%200%200%201-3.4%203.37l-7.67%201.99c-.57.15-.61.95-.05%201.15l8.09%202.8c1.45.5%202.57%201.68%203.01%203.15l2.89%2011.59c.15.6%201.01.61%201.16%200l2.99-11.63a4.773%204.773%200%200%201%203.04-3.13l8.1-2.72z'%20fill='%23f4b400'%20stroke='%23f4b400'%20stroke-miterlimit='10'%3e%3c/path%3e%3c/svg%3e",R0=""+new URL("../assets/knight.90IA5jkU.svg",import.meta.url).href;var A0=v('<img class="drop-shadow-md jitter" alt="W"/>'),T0=v('<img alt="P"/>'),M0=v('<img class="drop-shadow-md w-full h-full object-contain" alt="P"/>'),I0=v('<img class="w-full h-full object-contain" alt="G"/>'),j0=v('<img class="w-full h-full object-contain wiggle" alt="B"/>'),D0=v('<img class="w-full h-full object-contain waft" alt="S"/>'),O0=v('<div class="grid grid-cols-[repeat(auto-fit,minmax(0,1fr))]"><!> <!> <!> <!></div>'),S0=v('<div class="absolute w-full h-full flex flex-col items-center justify-center"><img class="w-1/2 drop-shadow-md" alt="K"/></div>'),B0=v('<div class="w-5/6"><!></div> <!>',1),E0=v('<div class="bg-gray-800 w-full h-full blur-md"></div>'),F0=v('<div class="flex flex-row items-center justify-center border-1 relative"><!></div>'),G0=v('<div class="grid aspect-square w-1/3 grid-flow-col border"></div>');function $0(s,t){n0(t,!0);var e=G0();e0(e,21,()=>t.world.grid,s0,(o,l,n)=>{var r=Q(),i=K(r);e0(i,17,()=>c(l),s0,(f,a,g)=>{var L=F0(),G=u(L);{var $=y=>{var R=B0(),O=K(R),S=u(O);{var P=p=>{var b=A0();C(()=>T(b,"src",x0)),m(p,b)},J=p=>{var b=Q(),A=K(b);{var E=M=>{var I=T0();C(()=>T(I,"src",y0)),m(M,I)},d0=M=>{var I=O0(),X=u(I);{var h0=_=>{var x=M0();C(()=>T(x,"src",k0)),m(_,x)};N(X,_=>{c(a).Treasure&&_(h0)})}var H=d(X,2);{var u0=_=>{var x=I0();C(()=>T(x,"src",N0)),m(_,x)};N(H,_=>{c(a).Glitter&&_(u0)})}var Y=d(H,2);{var f0=_=>{var x=j0();C(()=>T(x,"src",C0)),m(_,x)};N(Y,_=>{c(a).Breeze&&_(f0)})}var _0=d(Y,2);{var m0=_=>{var x=D0();C(()=>T(x,"src",L0)),m(_,x)};N(_0,_=>{c(a).Stench&&_(m0)})}h(I),m(M,I)};N(A,M=>{c(a).Pit?M(E):M(d0,!1)},!0)}m(p,b)};N(S,p=>{c(a).Wumpus?p(P):p(J,!1)})}h(O);var B=d(O,2);{var V=p=>{var b=S0(),A=u(b);h(b),C(E=>{r0(A,`rotate: ${E??""}deg;`),T(A,"src",R0)},[()=>k(-25,25)]),m(p,b)};N(B,p=>{n===t.world.hero.x&&g===t.world.hero.y&&p(V)})}m(y,R)},z=y=>{var R=E0();m(y,R)};N(G,y=>{c(a).discovered?y($):y(z,!1)})}h(L),m(f,L)}),m(o,r)}),h(e),C(()=>r0(e,`grid-template-columns: repeat(${t.world.size??""}, minmax(0, 1fr)); grid-template-rows: repeat(${t.world.size??""}, minmax(0, 1fr));`)),m(s,e),c0()}class z0{lookup=["*"];constructor(){}lit(t,e=!1){const o=this.lookup.indexOf(t);if(o>0)return{kind:"LITERAL",value:e?-o:o};this.lookup.push(t);const l=this.lookup.length-1;return{kind:"LITERAL",value:e?-l:l}}not(t){return this.lit(t,!0)}resolve_name(t){return(t<0?"¬":"")+this.lookup[Math.abs(t)]}convert_to_CNF(t){if(t.kind==="TERM")return this.convert_to_CNF(t.symbol);const e=[];if(t.kind!=="AND")throw`Couldn't convert ${this.format_expr(t)} to CNF!`;for(const o of t.symbols){let l;switch(o.kind){case"LITERAL":l=new Set([o.value]);break;case"OR":l=new Set(o.symbols.map(n=>{if(n.kind!=="LITERAL")throw"Disallowed!";return n.value}));break;case"NOT":case"AND":case"IMPL":case"BICOND":case"TERM":throw`${o.kind} disallowed when creating CNF!`}i0(e,l)||e.push(l)}return{kind:"CNF",clauses:e}}convert_to_AND(t){const e={kind:"AND",symbols:[]};for(const o of t.clauses){const l={kind:"OR",symbols:[]};for(const n of o.values())l.symbols.push({kind:"LITERAL",value:n});e.symbols.push(l)}return e}PL_resolution(t,e){const l=[...this.convert_to_CNF(this.expand_dependend_exprs(o0(D(t,P0(e))))).clauses];let n=[];for(;;){for(let r=0;r<l.length;r++)for(let i=r+1;i<l.length;i++){const f=l[r],a=l[i],g=J0(f,a);for(const L of g)if(i0(l,L)||n.push(L),L.size===0)return l.push,{result:!0,cnf:{kind:"CNF",clauses:l}}}if(n.length===0)return{result:!1,cnf:{kind:"CNF",clauses:l}};l.push(...n),n=[]}}format_expr(t){switch(t.kind){case"TERM":return`${this.format_expr(t.symbol)}`;case"LITERAL":return`${this.resolve_name(t.value)}`;case"NOT":return`¬ ${this.format_expr(t.symbol)}`;case"AND":return t.symbols.length===1?this.format_expr(t.symbols[0]):`(${t.symbols.map(e=>this.format_expr(e)).join(" ∧ ")})`;case"OR":return t.symbols.length===1?this.format_expr(t.symbols[0]):`(${t.symbols.map(e=>this.format_expr(e)).join(" ∨ ")})`;case"IMPL":return`(${this.format_expr(t.left)} ⇒ ${this.format_expr(t.right)})`;case"BICOND":return`(${this.format_expr(t.left)} ⇔ ${this.format_expr(t.right)})`;case"CNF":return`[${t.clauses.map(e=>"["+[...e].map(o=>this.resolve_name(o)).join(" ∨ ")+"]").join(", ")}]`}}format_each_expr(t){return[...t].map(e=>this.format_expr(e)).join(", ")}expand_again(t,e,o){t&&(console.log("..".repeat(o)+this.format_expr(e)),this.expand_dependend_exprs(e,o+1))}expand_to_CNF(t){return this.expand_dependend_exprs(o0(H0(t)))}expand_to_AND(t){return this.convert_to_AND(this.convert_to_CNF(this.expand_to_CNF(t)))}expand_dependend_exprs(t,e=0){switch(t.kind){case"LITERAL":break;case"AND":case"OR":for(let r=0;r<t.symbols.length;r++){this.expand_dependend_exprs(t.symbols[r],e+1);const i=q(t.symbols[r]);t.symbols[r]=i.expr,this.expand_again(i.changed,t,e)}break;case"IMPL":case"BICOND":this.expand_dependend_exprs(t.left,e+1),this.expand_dependend_exprs(t.right,e+1);const o=q(t.left),l=q(t.right);this.expand_again(o.changed||l.changed,t,e);break;case"NOT":case"TERM":this.expand_dependend_exprs(t.symbol,e+1);const n=q(t.symbol);t.symbol=n.expr,this.expand_again(n.changed,t,e);break}return t}}function P0(s){return{kind:"NOT",symbol:s}}function D(...s){return{kind:"AND",symbols:s}}function V0(...s){return{kind:"OR",symbols:s}}function W0(s,t){return{kind:"BICOND",left:s,right:t}}function o0(s){return{kind:"TERM",symbol:s}}function q(s){switch(s.kind){case"LITERAL":return{changed:!1,expr:s};case"NOT":{const t=s.symbol;switch(t.kind){case"LITERAL":return{changed:!0,expr:{kind:"LITERAL",value:-t.value}};case"NOT":return{changed:!0,expr:t.symbol};case"AND":case"OR":const e=[];for(const o of t.symbols)e.push({kind:"NOT",symbol:o});return{changed:!0,expr:{kind:t.kind==="AND"?"OR":"AND",symbols:e}};case"IMPL":case"BICOND":return{changed:!1,expr:s};case"TERM":return s.symbol=t.symbol,{changed:!0,expr:s}}}case"AND":case"OR":{let t=!1;const e=[];for(const o of s.symbols)o.kind===s.kind?(t=!0,e.push(...o.symbols)):e.push(o);return s.symbols=e,!t&&s.kind==="OR"?{changed:!1,expr:q0(s)}:{changed:t,expr:s}}case"IMPL":{const t=s.left,e=s.right;return{changed:!0,expr:{kind:"OR",symbols:[{kind:"NOT",symbol:t},e]}}}case"BICOND":{const t=s.left,e=s.right;return{changed:!0,expr:{kind:"AND",symbols:[{kind:"IMPL",left:t,right:e},{kind:"IMPL",left:e,right:t}]}}}case"TERM":return{changed:!1,expr:s.symbol}}}function U0(s){if(s.kind!=="OR")return!1;for(const t of s.symbols)if(t.kind!=="LITERAL")return!1;return!0}function q0(s){if(U0(s))return s;let t=l0(s.symbols[0]);for(let o=1;o<s.symbols.length;o++){const l=s.symbols[o],n=l0(l),r={kind:"AND",symbols:[]};for(const i of t.symbols)for(const f of n.symbols)r.symbols.push({kind:"OR",symbols:[i,f]});t=r}let e;return t.symbols.length===1?e=t.symbols[0]:e=t,e}function l0(s){return s.kind==="AND"?s:{kind:"AND",symbols:[s]}}function J0(s,t){const e=[];for(let o of s)if(t.has(-o)){const l=s.difference(new Set([o])).union(t.difference(new Set([-o])));K0(l)||e.push(l)}return e}function K0(s){for(let t of s)for(let e of s)if(t===-e)return!0;return!1}function X0(s,t){if(s.size!==t.size)return!1;for(const e of s)if(!t.has(e))return!1;return!0}function i0(s,t){for(const e of s)if(X0(e,t))return!0;return!1}function H0(s){return JSON.parse(JSON.stringify(s))}class a0{#t=F(5);get size(){return c(this.#t)}set size(t){w(this.#t,t,!0)}#e=F(W([]));get grid(){return c(this.#e)}set grid(t){w(this.#e,t,!0)}#s=F(W(new z0));get ctx(){return c(this.#s)}set ctx(t){w(this.#s,t,!0)}#r=F(W({x:0,y:0}));get hero(){return c(this.#r)}set hero(t){w(this.#r,t,!0)}#o=F(W({kind:"AND",symbols:[]}));get hero_kb(){return c(this.#o)}set hero_kb(t){w(this.#o,t,!0)}#l=j(()=>this.ctx.format_expr(this.hero_kb));get hero_kb_text(){return c(this.#l)}set hero_kb_text(t){w(this.#l,t)}#i=j(()=>this.get_cell(this.hero.x,this.hero.y));get local_cell(){return c(this.#i)}set local_cell(t){w(this.#i,t)}#n=j(()=>this.ctx.format_expr(this.local_cell.rules));get local_rule(){return c(this.#n)}set local_rule(t){w(this.#n,t)}#c=j(()=>this.ctx.format_expr(this.local_cell.state));get local_state(){return c(this.#c)}set local_state(t){w(this.#c,t)}#a=j(()=>this.ctx.format_expr(this.ctx.expand_to_CNF(D(this.local_cell.rules,this.hero_kb))));get local_cnf(){return c(this.#a)}set local_cnf(t){w(this.#a,t)}#d=j(()=>this.get_adjacent_literals(this.hero.x,this.hero.y));get test_literals(){return c(this.#d)}set test_literals(t){w(this.#d,t)}constructor(t){this.size=t;const e=k(0,t),o=k(0,t);let l=k(0,t),n=k(0,t);l===e&&n===o&&(t0(0,1)>.5?l+=1-k(0,1)*2:n+=1-k(0,1)*2);for(let r=0;r<t;r++){this.grid.push([]);for(let i=0;i<t;i++)this.grid[r].push({Wumpus:r===e&&i===o,Treasure:r===l&&i===n,Pit:r!==e&&i!==o&&r!==l&&i!==n&&t0(0,1)>.6,Glitter:!1,Breeze:!1,Stench:!1,rules:D(),state:D(),discovered:!1})}for(let r=0;r<t;r++)for(let i=0;i<t;i++)this.grid[r][i].Wumpus?this.set_adjacent(r,i,"Stench",!0):this.grid[r][i].Pit?this.set_adjacent(r,i,"Breeze",!0):this.grid[r][i].Treasure&&this.set_adjacent(r,i,"Glitter",!0);for(let r=0;r<t;r++)for(let i=0;i<t;i++){const f=this.get_cell(r,i),a=[],g=[];a.push(this.create_adjacent_rule("B","P",r,i)),a.push(this.create_adjacent_rule("G","T",r,i)),a.push(this.create_adjacent_rule("S","W",r,i)),g.push(this.ctx.lit(`B${r}${i}`,!f.Breeze)),g.push(this.ctx.lit(`S${r}${i}`,!f.Stench)),g.push(this.ctx.lit(`G${r}${i}`,!f.Glitter)),this.grid[r][i].rules=D(...a),this.grid[r][i].state=D(...g)}for(let r=0;r<1e3;r++){const i=k(0,t),f=k(0,t),a=this.get_cell(i,f);a.Wumpus||a.Treasure||a.Pit||a.Breeze||a.Stench||(this.hero.x=i,this.hero.y=f)}this.observe()}create_adjacent_rule(t,e,o,l){const n=this.ctx.lit(`${t}${o}${l}`),r=[];return o>0&&r.push(this.ctx.lit(`${e}${o-1}${l}`)),o<this.size-1&&r.push(this.ctx.lit(`${e}${o+1}${l}`)),l>0&&r.push(this.ctx.lit(`${e}${o}${l-1}`)),l<this.size-1&&r.push(this.ctx.lit(`${e}${o}${l+1}`)),W0(n,V0(...r))}observe(){const t=this.get_cell(this.hero.x,this.hero.y);t.discovered=!0,this.hero_kb.symbols.push(...this.local_cell.state.symbols),this.hero_kb=this.ctx.expand_to_AND(this.hero_kb)}move(t,e){this.hero=b0(w0(this.hero,{x:t,y:e}),0,this.size-1,0,this.size-1),this.observe()}move_left(){this.move(-1,0)}move_right(){this.move(1,0)}move_up(){this.move(0,-1)}move_down(){this.move(0,1)}set_adjacent(t,e,o,l){for(const n of[t-1,t+1]){const r=this.get_cell(n,e);r&&(r[o]=l)}for(const n of[e-1,e+1]){const r=this.get_cell(t,n);r&&(r[o]=l)}}get_cell(t,e){if(t<0||e<0)return;const o=this.grid.at(t);return o===void 0?void 0:o.at(e)}get_adjacent_literals(t,e){return[]}}function Y0(s,t){w(t,new a0(k(4,8)))}var Q0=(s,t)=>c(t).move_up(),Z0=(s,t)=>c(t).move_left(),t2=(s,t)=>c(t).move_right(),e2=(s,t)=>c(t).move_down(),s2=v('<div class="flex flex-col gap-2 p-2"><h1>Wumpus world | <a href="../">back</a></h1> <div class="flex flex-row"><div class="grid grid-cols-3 grid-rows-3"><div></div> <button class="border">up</button> <div></div> <button class="border">left</button> <div></div> <button class="border">right</button> <div></div> <button class="border">down</button> <div></div></div></div> <div class="flex flex-row items-center"><button class="border">reset</button></div> <!> <table><tbody><tr><th>Hero KB</th><td> </td></tr><tr><th>Local rules</th><td> </td></tr><tr><th>Current observation</th><td> </td></tr><tr><th>Local hero CNF</th><td> </td></tr></tbody></table> <div class="pl-2 pr-2">Test:</div></div>');function f2(s,t){n0(t,!1);let e=g0(new a0(4));v0();var o=s2(),l=d(u(o),2),n=u(l),r=d(u(n),2);r.__click=[Q0,e];var i=d(r,4);i.__click=[Z0,e];var f=d(i,4);f.__click=[t2,e];var a=d(f,4);a.__click=[e2,e],Z(2),h(n),h(l);var g=d(l,2),L=u(g);L.__click=[Y0,e],h(g);var G=d(g,2);$0(G,{get world(){return c(e)}});var $=d(G,2),z=u($),y=u(z),R=d(u(y)),O=u(R,!0);h(R),h(y);var S=d(y),P=d(u(S)),J=u(P,!0);h(P),h(S);var B=d(S),V=d(u(B)),p=u(V,!0);h(V),h(B);var b=d(B),A=d(u(b)),E=u(A,!0);h(A),h(b),h(z),h($),Z(2),h(o),C(()=>{U(O,c(e).hero_kb_text),U(J,c(e).local_rule),U(p,c(e).local_state),U(E,c(e).local_cnf)}),m(s,o),c0()}p0(["click"]);export{f2 as component};
